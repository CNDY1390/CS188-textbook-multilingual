<!-- Smart Language Toggle -->
<div class="language-toggle" style="position: fixed; top: 20px; right: 20px; z-index: 1000;">
  {%- if page.lang == 'zh-cn' -%}
    <a href="javascript:void(0)" onclick="switchToEnglish()" class="btn btn-outline" style="padding: 8px 16px;">
      ðŸ‡ºðŸ‡¸ English
    </a>
  {%- else -%}
    <a href="javascript:void(0)" onclick="switchToChinese()" class="btn btn-outline" style="padding: 8px 16px;">
      ðŸ‡¨ðŸ‡³ ç®€ä½“ä¸­æ–‡
    </a>
  {%- endif -%}
</div>

<script>
function switchToChinese() {
  var currentPath = window.location.pathname;
  var basePath = '{{ site.baseurl }}';
  
  // Remove baseurl to get relative path
  var relativePath = currentPath.replace(basePath, '');
  
  // If already in zh-cn, do nothing
  if (relativePath.startsWith('/zh-cn/')) {
    return;
  }
  
  // Add /zh-cn/ prefix
  var newPath = basePath + '/zh-cn' + relativePath;
  
  // Handle index pages
  if (newPath.endsWith('/')) {
    newPath += 'index.html';
  } else if (!newPath.includes('.html')) {
    newPath += '.html';
  }
  
  window.location.href = newPath;
}

function switchToEnglish() {
  var currentPath = window.location.pathname;
  var basePath = '{{ site.baseurl }}';
  
  // Remove /zh-cn/ from path
  var newPath = currentPath.replace('/zh-cn/', '/');
  
  // Handle index pages
  if (newPath.endsWith('/')) {
    newPath += 'index.html';
  }
  
  window.location.href = newPath;
}
</script>

<style>
.language-toggle {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

.language-toggle .btn {
  text-decoration: none;
  border-radius: 6px;
  background: var(--body-background-color);
  border: 1px solid var(--border-color);
  color: var(--body-text-color);
  transition: all 0.2s ease;
  display: inline-block;
  font-size: 14px;
  font-weight: 500;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.language-toggle .btn:hover {
  background: var(--sidebar-color);
  border-color: var(--link-color);
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  transform: translateY(-1px);
}

/* Mobile responsive */
@media (max-width: 768px) {
  .language-toggle {
    top: 10px;
    right: 10px;
  }
  
  .language-toggle .btn {
    font-size: 12px;
    padding: 6px 12px !important;
  }
}
</style>
